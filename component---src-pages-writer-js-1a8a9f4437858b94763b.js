"use strict";(self.webpackChunkdream_machine=self.webpackChunkdream_machine||[]).push([[177],{4360:function(e,t,n){n.r(t);var r=n(5861),a=n(4578),u=n(7757),s=n.n(u),i=n(7294);function c(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new l(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function l(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return l=function(e){this.s=e,this.n=e.next},l.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new l(e)}var o=function(e){function t(t){var n;return(n=e.call(this,t)||this).chooseMDXSaveDirectory=(0,r.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showDirectoryPicker();case 2:return t=e.sent,console.log(t),e.next=6,n.verifyPermission(t,!0);case 6:n.setState({mdxSaveDirHandle:t});case 7:case"end":return e.stop()}}),e)}))),n.chooseDirectory=(0,r.Z)(s().mark((function e(){var t,r,a,u,i,l,o,f,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showDirectoryPicker();case 2:t=e.sent,console.log(t),r=[],a=!1,u=!1,e.prev=7,l=c(t.values());case 9:return e.next=11,l.next();case 11:if(!(a=!(o=e.sent).done)){e.next=21;break}if("file"===(f=o.value).kind){e.next=15;break}return e.abrupt("break",21);case 15:if(!f.name.startsWith(".")){e.next=17;break}return e.abrupt("continue",18);case 17:r.push(f.getFile());case 18:a=!1,e.next=9;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(7),u=!0,i=e.t0;case 27:if(e.prev=27,e.prev=28,!a||null==l.return){e.next=32;break}return e.next=32,l.return();case 32:if(e.prev=32,!u){e.next=35;break}throw i;case 35:return e.finish(32);case 36:return e.finish(27);case 37:return e.next=39,Promise.all(r);case 39:m=e.sent,n.setState({currentFiles:m});case 41:case"end":return e.stop()}}),e,null,[[7,23,27,37],[28,,32,36]])}))),n.onChange=function(e){var t=e.target,r=t.value,a=t.name,u=n.state;u[a]=r,n.setState(u)},n.nextImage=function(){var e=n.state,t=e.currentFile,r=e.currentFiles,a=r,u=t+1;u>=r.length&&(u=0,a=[]),n.setState({title:"",subtitle:"",slug:"",creator:"",currentFile:u,currentFiles:a})},n.onSubmit=function(){var e=(0,r.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.saveJSON();case 3:return n.nextImage(),e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onSkip=function(e){e.preventDefault(),n.nextImage()},n.verifyPermission=function(){var e=(0,r.Z)(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},n&&(r.mode="readwrite"),e.next=4,t.queryPermission(r);case 4:if(e.t0=e.sent,"granted"!==e.t0){e.next=7;break}return e.abrupt("return",!0);case 7:return e.next=9,t.requestPermission(r);case 9:if(e.t1=e.sent,"granted"!==e.t1){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.getFileName=function(){var e=n.state,t=e.title,r=e.slug;return(""!==r?r:""!==t?t:"untitled").trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9]/gi,"")},n.saveJSON=(0,r.Z)(s().mark((function e(){var t,r,a,u,i,l,o,f,m,p,v,b,h,x,d,g,w,k,y,S,E,C,F,D,I,O,P,H,N,j;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("saving json"),t=n.state,r=t.mdxSaveDirHandle,a=t.currentFile,u=t.currentFiles,i=t.lastCategory,l=u[a],o=n.getFileName()+".json",f=null,m=!1,p=!1,e.prev=7,b=c(r.values());case 9:return e.next=11,b.next();case 11:if(!(m=!(h=e.sent).done)){e.next=17;break}(x=h.value).name===o&&(f=x);case 14:m=!1,e.next=9;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),p=!0,v=e.t0;case 23:if(e.prev=23,e.prev=24,!m||null==b.return){e.next=28;break}return e.next=28,b.return();case 28:if(e.prev=28,!p){e.next=31;break}throw v;case 31:return e.finish(28);case 32:return e.finish(23);case 33:if(!f){e.next=60;break}return e.next=36,f.getFile();case 36:return d=e.sent,e.next=39,d.text();case 39:if(g=e.sent,w=JSON.parse(g),k=w.categories[0],y="../src/assets/images/item/"+k+"/"+l.name,""!==w.featuredImage){e.next=51;break}return e.next=46,window.confirm("Make featured image?");case 46:if(!e.sent){e.next=50;break}w.featuredImage=y,e.next=51;break;case 50:w.featuredImage="";case 51:return w.views.push(y),S=JSON.stringify(w),e.next=55,n.getSaveHandle(o,r);case 55:return E=e.sent,e.next=58,n.writeFile(E,S);case 58:e.next=85;break;case 60:return C={},F=n.state,D=F.title,I=F.subtitle,O=F.creator,C.title=D,C.subtitle=I,C.creator=O,e.next=67,prompt("Item category?",i);case 67:return(P=e.sent)!==i&&n.setState({lastCategory:P}),C.categories=[P],H="../src/assets/images/item/"+P+"/"+l.name,e.next=73,window.confirm("Make featured image?");case 73:if(!e.sent){e.next=77;break}C.featuredImage=H,e.next=78;break;case 77:C.featuredImage="";case 78:return C.views=[H],N=JSON.stringify(C),e.next=82,n.getSaveHandle(o,r);case 82:return j=e.sent,e.next=85,n.writeFile(j,N);case 85:case"end":return e.stop()}}),e,null,[[7,19,23,33],[24,,28,32]])}))),n.getSaveHandle=function(){var e=(0,r.Z)(s().mark((function e(t,n){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return",n.getFileHandle(t,{create:!0}));case 2:return r=n||"Documents",e.next=5,window.showSaveFilePicker({suggestedName:t,startIn:r});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.writeFile=function(){var e=(0,r.Z)(s().mark((function e(t,n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createWritable();case 2:return r=e.sent,e.next=5,r.write(n);case 5:return e.next=7,r.close();case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.state={mdxSaveDirHandle:null,currentFiles:[],currentFile:0,title:"",subtitle:"",creator:"",slug:"",lastCategory:"christmas"},n}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.currentFiles,r=t.currentFile,a=t.title,u=t.subtitle,s=t.creator,c=t.slug,l=t.mdxSaveDirHandle,o=window.URL||window.webkitURL;return i.createElement("div",null,i.createElement("h1",null,"Writer"),i.createElement("button",{onClick:this.chooseMDXSaveDirectory},"CHOOSE JSON SAVE DIRECTORY"),i.createElement("p",null,l&&l.name),i.createElement("br",null),i.createElement("br",null),i.createElement("button",{onClick:this.chooseDirectory},"CHOOSE DIRECTORY"),n.length>0&&i.createElement("div",null,i.createElement("img",{src:o.createObjectURL(n[r]),style:{width:"100%"}}),i.createElement("form",{onSubmit:function(t){return e.onSubmit(t)}},i.createElement("label",null,"Title"),i.createElement("input",{type:"text",name:"title",onChange:function(t){return e.onChange(t)},value:a}),i.createElement("br",null),i.createElement("label",null,"Subtitle"),i.createElement("input",{type:"text",name:"subtitle",onChange:function(t){return e.onChange(t)},value:u}),i.createElement("br",null),i.createElement("label",null,"Creator"),i.createElement("input",{type:"text",name:"creator",onChange:function(t){return e.onChange(t)},value:s}),i.createElement("br",null),i.createElement("label",null,"Slug"),i.createElement("input",{type:"text",name:"slug",onChange:function(t){return e.onChange(t)},value:c}),i.createElement("br",null),i.createElement("p",null,this.getFileName()+".json"),i.createElement("button",{submit:!0},"SUBMIT"),i.createElement("br",null),i.createElement("br",null),i.createElement("br",null),i.createElement("button",{onClick:function(t){return e.onSkip(t)}},"SKIP"))))},t}(i.Component);t.default=o},5861:function(e,t,n){function r(e,t,n,r,a,u,s){try{var i=e[u](s),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,u){var s=e.apply(t,n);function i(e){r(s,a,u,i,c,"next",e)}function c(e){r(s,a,u,i,c,"throw",e)}i(void 0)}))}}n.d(t,{Z:function(){return a}})}}]);
//# sourceMappingURL=component---src-pages-writer-js-1a8a9f4437858b94763b.js.map